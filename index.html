<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Agenda Personale</title>
  <style>
    body {
      font-family: 'Lexend', sans-serif;
      background: #f0f2f5;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .container {
      width: 100%;
      max-width: 900px;
      padding: 10px;
      box-sizing: border-box;
    }
    h1 {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 3em;
      color: #003366;
      text-shadow: 2px 2px 5px rgba(255, 215, 0, 0.6);
      margin: 20px auto;
      text-align: center;
    }
    .section, .calendar-container {
      width: 100%;
      margin: 20px auto;
      background: white;
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      box-sizing: border-box;
    }
    h2 {
      color: #003366;
      margin-bottom: 15px;
      text-align: center;
    }
    input, textarea {
      width: 100%;
      max-width: 600px;
      padding: 10px;
      margin: 10px auto;
      border: none;
      border-radius: 8px;
      background: #f9f9f9;
      display: block;
    }
    button {
      background: #003366;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 8px;
      cursor: pointer;
      margin: 5px auto;
      display: inline-block;
    }
    ul {
      list-style: none;
      padding: 0;
      margin: 0 auto;
      max-width: 600px;
      text-align: left;
    }
    ul li {
      background: #e9ecef;
      margin: 5px 0;
      padding: 8px;
      border-radius: 6px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .delete-btn {
      background: #dc3545;
      border: none;
      padding: 5px 8px;
      color: white;
      border-radius: 6px;
      cursor: pointer;
    }
    .share-btn { background: #28a745; }

    /* Calendario */
    .calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
    }
    .day-name {
      font-weight: bold;
      color: #003366;
      text-align: center;
    }
    .day {
      background: #e9ecef;
      border-radius: 8px;
      padding: 10px;
      min-height: 60px;
      position: relative;
      cursor: pointer;
      transition: 0.2s;
      text-align: center;
    }
    .day:hover { background: #d6e4ff; }
    .has-event { background: #ffd966; }
    .event-dot {
      width: 8px;
      height: 8px;
      background: red;
      border-radius: 50%;
      position: absolute;
      bottom: 5px;
      right: 5px;
    }
    /* Modale */
    #eventModal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
    }
    #eventModal .modal-content {
      background: white;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      width: 90%;
      max-width: 400px;
    }
    @media(max-width:600px){
      h1 { font-size: 2.2em; }
      input, textarea { max-width: 100%; }
      ul { max-width: 100%; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>AgendaPersonale</h1>

    <!-- Sezione Promemoria -->
    <div class="section">
      <h2>Registra Promemoria</h2>
      <input type="text" id="promemoriaInput" placeholder="Scrivi un promemoria...">
      <button onclick="aggiungiPromemoria()">Aggiungi</button>
      <ul id="promemoriaList"></ul>
    </div>

    <!-- Lista della spesa -->
    <div class="section">
      <h2>Lista della Spesa</h2>
      <input type="text" id="spesaInput" placeholder="Aggiungi un prodotto...">
      <button onclick="aggiungiSpesa()">Aggiungi</button>
      <button class="share-btn" onclick="condividiLista()">Condividi su WhatsApp</button>
      <ul id="spesaList"></ul>
    </div>

    <!-- Calendario -->
    <div class="calendar-container">
      <h2>Calendario</h2>
      <div class="calendar-header">
        <button onclick="cambiaMese(-1)">&#8592;</button>
        <span id="meseAnno"></span>
        <button onclick="cambiaMese(1)">&#8594;</button>
      </div>
      <div class="calendar-grid" id="calendar"></div>
    </div>
  </div>

  <!-- Modale eventi -->
  <div id="eventModal">
    <div class="modal-content">
      <h3 id="eventDate"></h3>
      <textarea id="eventText" placeholder="Scrivi un promemoria..."></textarea>
      <button onclick="salvaEvento()">Salva</button>
      <button onclick="cancellaEvento()">Cancella</button>
      <button onclick="chiudiModal()">Chiudi</button>
    </div>
  </div>

  <script>
    // PROMEMORIA
    function aggiungiPromemoria() {
      const input = document.getElementById('promemoriaInput');
      if(input.value.trim() !== ""){
        const li = document.createElement('li');
        li.textContent = input.value;
        const btn = document.createElement('button');
        btn.textContent = "X";
        btn.className = "delete-btn";
        btn.onclick = () => li.remove();
        li.appendChild(btn);
        document.getElementById('promemoriaList').appendChild(li);
        input.value = "";
      }
    }

    // LISTA SPESA
    function aggiungiSpesa() {
      const input = document.getElementById('spesaInput');
      if(input.value.trim() !== ""){
        const li = document.createElement('li');
        li.textContent = input.value;
        const btn = document.createElement('button');
        btn.textContent = "X";
        btn.className = "delete-btn";
        btn.onclick = () => li.remove();
        li.appendChild(btn);
        document.getElementById('spesaList').appendChild(li);
        input.value = "";
      }
    }

    function condividiLista() {
      const items = document.querySelectorAll("#spesaList li");
      let testo = "Lista della Spesa:\n";
      items.forEach(item => testo += "- " + item.childNodes[0].textContent + "\n");
      const url = "https://wa.me/?text=" + encodeURIComponent(testo);
      window.open(url, "_blank");
    }

    // CALENDARIO
    let currentDate = new Date();
    let eventi = {};
    let selectedDate = null;

    function renderCalendar() {
      const calendar = document.getElementById("calendar");
      const meseAnno = document.getElementById("meseAnno");
      calendar.innerHTML = "";

      const mese = currentDate.getMonth();
      const anno = currentDate.getFullYear();

      meseAnno.textContent = currentDate.toLocaleString("it-IT", { month: "long", year: "numeric" });

      const firstDay = new Date(anno, mese, 1).getDay();
      const giorniMese = new Date(anno, mese+1, 0).getDate();

      const giorniSettimana = ["L","M","M","G","V","S","D"];
      giorniSettimana.forEach(g => {
        const div = document.createElement("div");
        div.textContent = g;
        div.className = "day-name";
        calendar.appendChild(div);
      });

      for(let i=1; i < (firstDay===0?7:firstDay); i++){
        const div = document.createElement("div");
        calendar.appendChild(div);
      }

      for(let g=1; g<=giorniMese; g++){
        const div = document.createElement("div");
        div.textContent = g;
        div.className = "day";
        const key = `${anno}-${mese+1}-${g}`;
        if(eventi[key]){
          div.classList.add("has-event");
          const dot = document.createElement("div");
          dot.className = "event-dot";
          div.appendChild(dot);
        }
        div.onclick = () => apriModal(key);
        calendar.appendChild(div);
      }
    }

    function cambiaMese(offset){
      currentDate.setMonth(currentDate.getMonth()+offset);
      renderCalendar();
    }

    function apriModal(data){
      selectedDate = data;
      document.getElementById("eventDate").textContent = data;
      document.getElementById("eventText").value = eventi[data] || "";
      document.getElementById("eventModal").style.display = "flex";
    }

    function salvaEvento(){
      const text = document.getElementById("eventText").value.trim();
      if(text){
        eventi[selectedDate] = text;
      } else {
        delete eventi[selectedDate];
      }
      chiudiModal();
      renderCalendar();
    }

    function cancellaEvento(){
      delete eventi[selectedDate];
      chiudiModal();
      renderCalendar();
    }

    function chiudiModal(){
      document.getElementById("eventModal").style.display = "none";
    }

    renderCalendar();
  </script>
</body>
</html>
